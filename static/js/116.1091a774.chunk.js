"use strict";(self.webpackChunkbabylonjs_check=self.webpackChunkbabylonjs_check||[]).push([[116],{8116:(e,n,t)=>{t.r(n),t.d(n,{_ExrTextureLoader:()=>oe});var r=t(8274),o=t(852);const a=4,i=4,l=1,c=2,s=8,u=65536,f=u>>3,w=14,h=65537,p=1<<w,y=p-1,d=59,b=63,v=2+b-d;var S,E;!function(e){e[e.NO_COMPRESSION=0]="NO_COMPRESSION",e[e.RLE_COMPRESSION=1]="RLE_COMPRESSION",e[e.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",e[e.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",e[e.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",e[e.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(S||(S={})),function(e){e[e.INCREASING_Y=0]="INCREASING_Y",e[e.DECREASING_Y=1]="DECREASING_Y"}(E||(E={}));const g=function(){const e=new ArrayBuffer(4),n=new Float32Array(e),t=new Uint32Array(e),r=new Uint32Array(512),o=new Uint32Array(512);for(let c=0;c<256;++c){const e=c-127;e<-27?(r[c]=0,r[256|c]=32768,o[c]=24,o[256|c]=24):e<-14?(r[c]=1024>>-e-14,r[256|c]=1024>>-e-14|32768,o[c]=-e-1,o[256|c]=-e-1):e<=15?(r[c]=e+15<<10,r[256|c]=e+15<<10|32768,o[c]=13,o[256|c]=13):e<128?(r[c]=31744,r[256|c]=64512,o[c]=24,o[256|c]=24):(r[c]=31744,r[256|c]=64512,o[c]=13,o[256|c]=13)}const a=new Uint32Array(2048),i=new Uint32Array(64),l=new Uint32Array(64);for(let c=1;c<1024;++c){let e=c<<13,n=0;for(;0===(8388608&e);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,a[c]=e|n}for(let c=1024;c<2048;++c)a[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)i[c]=c<<23;i[31]=1199570944,i[32]=2147483648;for(let c=33;c<63;++c)i[c]=2147483648+(c-32<<23);i[63]=3347054592;for(let c=1;c<64;++c)32!==c&&(l[c]=1024);return{floatView:n,uint32View:t,baseTable:r,shiftTable:o,mantissaTable:a,exponentTable:i,offsetTable:l}}();function A(e,n){const t=new Uint8Array(e);let r=0;for(;0!=t[n.value+r];)r+=1;const o=(new TextDecoder).decode(t.slice(n.value,n.value+r));return n.value=n.value+r+1,o}function O(e,n){const t=e.getInt32(n.value,!0);return n.value+=a,t}function I(e,n){const t=e.getUint32(n.value,!0);return n.value+=a,t}function C(e,n){const t=e.getUint8(n.value);return n.value+=l,t}function U(e,n){const t=e.getUint16(n.value,!0);return n.value+=c,t}function m(e,n){const t=e[n.value];return n.value+=l,t}function M(e,n){let t;return t="getBigInt64"in DataView.prototype?Number(e.getBigInt64(n.value,!0)):e.getUint32(n.value+4,!0)+Number(e.getUint32(n.value,!0)<<32),n.value+=s,t}function P(e,n){const t=e.getFloat32(n.value,!0);return n.value+=i,t}function k(e,n){return function(e){const n=(31744&e)>>10,t=1023&e;return(e>>15?-1:1)*(n?31===n?t?NaN:1/0:Math.pow(2,n-15)*(1+t/1024):t/1024*6103515625e-14)}(U(e,n))}function N(e,n){return function(e){if(Math.abs(e)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");e=(0,o.OQ)(e,-65504,65504),g.floatView[0]=e;const n=g.uint32View[0],t=n>>23&511;return g.baseTable[t]+((8388607&n)>>g.shiftTable[t])}(P(e,n))}function R(e,n,t,r){switch(t){case"string":case"stringvector":case"iccProfile":return function(e,n,t){const r=(new TextDecoder).decode(new Uint8Array(e).slice(n.value,n.value+t));return n.value=n.value+t,r}(e.buffer,n,r);case"chlist":return function(e,n,t){const r=n.value,o=[];for(;n.value<r+t-1;){const t=A(e.buffer,n),r=O(e,n),a=C(e,n);n.value+=3;const i=O(e,n),l=O(e,n);o.push({name:t,pixelType:r,pLinear:a,xSampling:i,ySampling:l})}return n.value+=1,o}(e,n,r);case"chromaticities":return function(e,n){return{redX:P(e,n),redY:P(e,n),greenX:P(e,n),greenY:P(e,n),blueX:P(e,n),blueY:P(e,n),whiteX:P(e,n),whiteY:P(e,n)}}(e,n);case"compression":return function(e,n){return C(e,n)}(e,n);case"box2i":return function(e,n){return{xMin:O(e,n),yMin:O(e,n),xMax:O(e,n),yMax:O(e,n)}}(e,n);case"lineOrder":return function(e,n){const t=C(e,n);return E[t]}(e,n);case"float":return P(e,n);case"v2f":return function(e,n){return[P(e,n),P(e,n)]}(e,n);case"v3f":return function(e,n){return[P(e,n),P(e,n),P(e,n)]}(e,n);case"int":return O(e,n);case"rational":return function(e,n){return[O(e,n),I(e,n)]}(e,n);case"timecode":return function(e,n){return[I(e,n),I(e,n)]}(e,n);case"preview":return n.value+=r,"skipped";default:return void(n.value+=r)}}function x(e){for(let n=1;n<e.length;n++){const t=e[n-1]+e[n]-128;e[n]=t}}function T(e,n){let t=0,r=Math.floor((e.length+1)/2),o=0;const a=e.length-1;for(;!(o>a)&&(n[o++]=e[t++],!(o>a));)n[o++]=e[r++]}const _=32768,z=65535;function L(e,n,t,r,o){for(;t<e;)n=n<<8|m(r,o),t+=8;return{l:n>>(t-=e)&(1<<e)-1,c:n,lc:t}}function F(e,n,t,r){return{c:e=e<<8|m(t,r),lc:n+=8}}function D(e,n,t,r,o,a,i,l,c){if(e==n){if(r<8){const e=F(t,r,o,a);t=e.c,r=e.lc}let e=t>>(r-=8);if(e=new Uint8Array([e])[0],l.value+e>c)return null;const n=i[l.value-1];for(;e-- >0;)i[l.value++]=n}else{if(!(l.value<c))return null;i[l.value++]=e}return{c:t,lc:r}}const B=new Array(59);function W(e,n,t,r,o,a){const i=n;let l=0,c=0;for(;r<=o;r++){if(i.value-n.value>t)return;let s=L(6,l,c,e,i);const u=s.l;if(l=s.c,c=s.lc,a[r]=u,u==b){if(i.value-n.value>t)throw new Error("Error in HufUnpackEncTable");s=L(8,l,c,e,i);let u=s.l+v;if(l=s.c,c=s.lc,r+u>o+1)throw new Error("Error in HufUnpackEncTable");for(;u--;)a[r++]=0;r--}else if(u>=d){let e=u-d+2;if(r+e>o+1)throw new Error("Error in HufUnpackEncTable");for(;e--;)a[r++]=0;r--}}!function(e){for(let t=0;t<=58;++t)B[t]=0;for(let t=0;t<h;++t)B[e[t]]+=1;let n=0;for(let t=58;t>0;--t){const e=n+B[t]>>1;B[t]=n,n=e}for(let t=0;t<h;++t){const n=e[t];n>0&&(e[t]=n|B[n]++<<6)}}(a)}function V(e){return 63&e}function Y(e){return e>>6}function H(e,n,t,r,o,a){const i=t.value,l=I(n,t),c=I(n,t);t.value+=4;const s=I(n,t);if(t.value+=4,l<0||l>=h||c<0||c>=h)throw new Error("Wrong HUF_ENCSIZE");const u=new Array(h),f=new Array(p);!function(e){for(let n=0;n<p;n++)e[n]={},e[n].len=0,e[n].lit=0,e[n].p=null}(f);if(W(e,t,r-(t.value-i),l,c,u),s>8*(r-(t.value-i)))throw new Error("Wrong hufUncompress");!function(e,n,t,r){for(;n<=t;n++){const t=Y(e[n]),o=V(e[n]);if(t>>o)throw new Error("Invalid table entry");if(o>w){const e=r[t>>o-w];if(e.len)throw new Error("Invalid table entry");if(e.lit++,e.p){const n=e.p;e.p=new Array(e.lit);for(let t=0;t<e.lit-1;++t)e.p[t]=n[t]}else e.p=new Array(1);e.p[e.lit-1]=n}else if(o){let e=0;for(let a=1<<w-o;a>0;a--){const a=r[(t<<w-o)+e];if(a.len||a.p)throw new Error("Invalid table entry");a.len=o,a.lit=n,e++}}}}(u,l,c,f),function(e,n,t,r,o,a,i,l,c){let s=0,u=0;const f=i,h=Math.trunc(r.value+(o+7)/8);for(;r.value<h;){let o=F(s,u,t,r);for(s=o.c,u=o.lc;u>=w;){const i=n[s>>u-w&y];if(i.len){u-=i.len;const e=D(i.lit,a,s,u,t,r,l,c,f);e&&(s=e.c,u=e.lc)}else{if(!i.p)throw new Error("hufDecode issues");let n;for(n=0;n<i.lit;n++){const w=V(e[i.p[n]]);for(;u<w&&r.value<h;)o=F(s,u,t,r),s=o.c,u=o.lc;if(u>=w&&Y(e[i.p[n]])==(s>>u-w&(1<<w)-1)){u-=w;const e=D(i.p[n],a,s,u,t,r,l,c,f);e&&(s=e.c,u=e.lc);break}}if(n==i.lit)throw new Error("HufDecode issues")}}}const p=8-o&7;for(s>>=p,u-=p;u>0;){const e=n[s<<w-u&y];if(!e.len)throw new Error("HufDecode issues");{u-=e.len;const n=D(e.lit,a,s,u,t,r,l,c,f);n&&(s=n.c,u=n.lc)}}}(u,f,e,t,s,c,a,o,{value:0})}function Z(e){return 65535&e}function X(e){const n=Z(e);return n>32767?n-65536:n}function G(e,n){const t=X(e),r=X(n),o=t+(1&r)+(r>>1);return{a:o,b:o-r}}function j(e,n){const t=Z(e),r=Z(n),o=t-(r>>1)&z;return{a:r+o-_&z,b:o}}function Q(e,n,t,r,o,a,i){const l=i<16384,c=t>o?o:t;let s,u,f=1;for(;f<=c;)f<<=1;for(f>>=1,s=f,f>>=1;f>=1;){u=0;const i=u+a*(o-s),c=a*f,w=a*s,h=r*f,p=r*s;let y,d,b,v;for(;u<=i;u+=w){let o=u;const a=u+r*(t-s);for(;o<=a;o+=p){const t=o+h,r=o+c,a=r+h;if(l){let i=G(e[o+n],e[r+n]);y=i.a,b=i.b,i=G(e[t+n],e[a+n]),d=i.a,v=i.b,i=G(y,d),e[o+n]=i.a,e[t+n]=i.b,i=G(b,v),e[r+n]=i.a,e[a+n]=i.b}else{let i=j(e[o+n],e[r+n]);y=i.a,b=i.b,i=j(e[t+n],e[a+n]),d=i.a,v=i.b,i=j(y,d),e[o+n]=i.a,e[t+n]=i.b,i=j(b,v),e[r+n]=i.a,e[a+n]=i.b}}if(t&f){const t=o+c;let r;r=l?G(e[o+n],e[t+n]):j(e[o+n],e[t+n]),y=r.a,e[t+n]=r.b,e[o+n]=y}}if(o&f){let o=u;const a=u+r*(t-s);for(;o<=a;o+=p){const t=o+h;let r;r=l?G(e[o+n],e[t+n]):j(e[o+n],e[t+n]),y=r.a,e[t+n]=r.b,e[o+n]=y}}s=f,f>>=1}return u}function $(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function q(e){const n=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),t=new Uint8Array(function(e){let n=e.byteLength;const t=new Array;let r=0;const o=new DataView(e);for(;n>0;){const e=o.getInt8(r++);if(e<0){const a=-e;n-=a+1;for(let e=0;e<a;e++)t.push(o.getUint8(r++))}else{const a=e;n-=2;const i=o.getUint8(r++);for(let e=0;e<a+1;e++)t.push(i)}}return t}(n)),r=new Uint8Array(t.length);return x(t),T(t,r),new DataView(r.buffer)}function J(e){const n=e.array.slice(e.offset.value,e.offset.value+e.size),t=fflate.unzlibSync(n),r=new Uint8Array(t.length);return x(t),T(t,r),new DataView(r.buffer)}function K(e){const n=e.array.slice(e.offset.value,e.offset.value+e.size),t=fflate.unzlibSync(n),r=e.lines*e.channels*e.width,o=1==e.type?new Uint16Array(r):new Uint32Array(r);let a=0,i=0;const l=new Array(4);for(let c=0;c<e.lines;c++)for(let n=0;n<e.channels;n++){let n=0;switch(e.type){case 1:l[0]=a,l[1]=l[0]+e.width,a=l[1]+e.width;for(let r=0;r<e.width;++r){n+=t[l[0]++]<<8|t[l[1]++],o[i]=n,i++}break;case 2:l[0]=a,l[1]=l[0]+e.width,l[2]=l[1]+e.width,a=l[2]+e.width;for(let r=0;r<e.width;++r){n+=t[l[0]++]<<24|t[l[1]++]<<16|t[l[2]++]<<8,o[i]=n,i++}}}return new DataView(o.buffer)}function ee(e){const n=e.viewer,t={value:e.offset.value},r=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),o=new Uint8Array(f);let a=0;const i=new Array(e.channels);for(let c=0;c<e.channels;c++)i[c]={},i[c].start=a,i[c].end=i[c].start,i[c].nx=e.width,i[c].ny=e.lines,i[c].size=e.type,a+=i[c].nx*i[c].ny*i[c].size;const l=U(n,t),s=U(n,t);if(s>=f)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(l<=s)for(let c=0;c<s-l+1;c++)o[c+l]=C(n,t);const w=new Uint16Array(u),h=function(e,n){let t=0;for(let o=0;o<u;++o)(0==o||e[o>>3]&1<<(7&o))&&(n[t++]=o);const r=t-1;for(;t<u;)n[t++]=0;return r}(o,w),p=I(n,t);H(e.array,n,t,p,r,a);for(let c=0;c<e.channels;++c){const e=i[c];for(let n=0;n<i[c].size;++n)Q(r,e.start+n,e.nx,e.size,e.ny,e.nx*e.size,h)}!function(e,n,t){for(let r=0;r<t;++r)n[r]=e[n[r]]}(w,r,a);let y=0;const d=new Uint8Array(r.buffer.byteLength);for(let u=0;u<e.lines;u++)for(let n=0;n<e.channels;n++){const e=i[n],t=e.nx*e.size,o=new Uint8Array(r.buffer,e.end*c,t*c);d.set(o,y),y+=t*c,e.end+=t}return new DataView(d.buffer)}var ne,te=t(543);!function(e){e[e.Float=0]="Float",e[e.HalfFloat=1]="HalfFloat"}(ne||(ne={}));class re{}re.DefaultOutputType=ne.HalfFloat,re.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class oe{constructor(){this.supportCascades=!1}loadCubeData(e,n,t,r,o){throw".exr not supported in Cube."}async loadData(e,n,t){const o=new DataView(e.buffer),a={value:0},l=function(e,n){if(20000630!=e.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const t=e.getUint8(4),o=e.getUint8(5),a={singleTile:!!(2&o),longName:!!(4&o),deepFormat:!!(8&o),multiPart:!!(16&o)};n.value=8;const i={};let l=!0;for(;l;){const t=A(e.buffer,n);if(t){const o=A(e.buffer,n),a=R(e,n,o,I(e,n));void 0===a?r.V.Warn(`Unknown header attribute type ${o}'.`):i[t]=a}else l=!1}if(0!=(-5&o))throw new Error("Unsupported file format");return{version:t,spec:a,...i}}(o,a),s=await async function(e,n,t,r){const o={size:0,viewer:n,array:new Uint8Array(n.buffer),offset:t,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(e.compression){case S.NO_COMPRESSION:o.lines=1,o.uncompress=$;break;case S.RLE_COMPRESSION:o.lines=1,o.uncompress=q;break;case S.ZIPS_COMPRESSION:o.lines=1,o.uncompress=J,await te.S0.LoadScriptAsync(re.FFLATEUrl);break;case S.ZIP_COMPRESSION:o.lines=16,o.uncompress=J,await te.S0.LoadScriptAsync(re.FFLATEUrl);break;case S.PIZ_COMPRESSION:o.lines=32,o.uncompress=ee;break;case S.PXR24_COMPRESSION:o.lines=16,o.uncompress=K,await te.S0.LoadScriptAsync(re.FFLATEUrl);break;default:throw new Error(S[e.compression]+" is unsupported")}o.scanlineBlockSize=o.lines;const a={};for(const i of e.channels)switch(i.name){case"Y":case"R":case"G":case"B":case"A":a[i.name]=!0,o.type=i.pixelType}let l=!1;if(a.R&&a.G&&a.B)l=!a.A,o.outputChannels=4,o.decodeChannels={R:0,G:1,B:2,A:3};else{if(!a.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");o.outputChannels=1,o.decodeChannels={Y:0}}if(1===o.type)switch(r){case ne.Float:o.getter=k,o.inputSize=c;break;case ne.HalfFloat:o.getter=U,o.inputSize=c}else{if(2!==o.type)throw new Error("Unsupported pixelType "+o.type+" for "+e.compression);switch(r){case ne.Float:o.getter=P,o.inputSize=i;break;case ne.HalfFloat:o.getter=N,o.inputSize=i}}o.blockCount=o.height/o.scanlineBlockSize;for(let i=0;i<o.blockCount;i++)M(n,t);const s=o.width*o.height*o.outputChannels;switch(r){case ne.Float:o.byteArray=new Float32Array(s),o.textureType=1,l&&o.byteArray.fill(1,0,s);break;case ne.HalfFloat:o.byteArray=new Uint16Array(s),o.textureType=2,l&&o.byteArray.fill(15360,0,s);break;default:throw new Error("Unsupported type: "+r)}let u=0;for(const i of e.channels)void 0!==o.decodeChannels[i.name]&&(o.channelLineOffsets[i.name]=u*o.width),u+=2*i.pixelType;return o.bytesPerLine=o.width*u,o.outLineWidth=o.width*o.outputChannels,"INCREASING_Y"===e.lineOrder?o.scanOrder=e=>e:o.scanOrder=e=>o.height-1-e,4==o.outputChannels?(o.format=5,o.linearSpace=!0):(o.format=6,o.linearSpace=!1),o}(l,o,a,re.DefaultOutputType);!function(e,n,t,r){const o={value:0};for(let a=0;a<e.height/e.scanlineBlockSize;a++){const i=O(t,r)-n.dataWindow.yMin;e.size=I(t,r),e.lines=i+e.scanlineBlockSize>e.height?e.height-i:e.scanlineBlockSize;const l=e.size<e.lines*e.bytesPerLine&&e.uncompress?e.uncompress(e):$(e);r.value+=e.size;for(let t=0;t<e.scanlineBlockSize;t++){const r=a*e.scanlineBlockSize,i=t+e.scanOrder(r);if(i>=e.height)continue;const c=t*e.bytesPerLine,s=(e.height-1-i)*e.outLineWidth;for(let t=0;t<e.channels;t++){const r=n.channels[t].name,a=e.channelLineOffsets[r],i=e.decodeChannels[r];if(void 0!==i){o.value=c+a;for(let n=0;n<e.width;n++){const t=s+n*e.outputChannels+i;e.byteArray&&(e.byteArray[t]=e.getter(l,o))}}}}}}(s,l,o,a);t(l.dataWindow.xMax-l.dataWindow.xMin+1,l.dataWindow.yMax-l.dataWindow.yMin+1,n.generateMipMaps,!1,(()=>{const e=n.getEngine();n.format=l.format,n.type=s.textureType,n.invertY=!1,n._gammaSpace=!l.linearSpace,s.byteArray&&e._uploadDataToTextureDirectly(n,s.byteArray,0,0,void 0,!0)}))}}}}]);
//# sourceMappingURL=116.1091a774.chunk.js.map